# Copyright (c) 2017 Shotgun Software Inc.
#
# CONFIDENTIAL AND PROPRIETARY
#
# This work is provided "AS IS" and subject to the Shotgun Pipeline Toolkit
# Source Code License included in this distribution package. See LICENSE.
# By accessing, using, copying or modifying this work you indicate your
# agreement to the Shotgun Pipeline Toolkit Source Code License. All rights
# not expressly granted therein are reserved by Shotgun Software Inc.

################################################################################

includes:
- ../app_locations.yml

################################################################################

# common_workfiles_hooks
common_workfiles_settings: &common_workfiles_settings
  # file_browser_tabs: ['Working']
  # hook_filter_publishes: "{config}/tk-multi-workfiles2/filter_publishes.py"
  show_change_context: true
  hook_filter_work_files: "{config}/tk-multi-workfiles2/filter_work_files.py"
  custom_actions_hook: "{config}/tk-multi-workfiles2/custom_actions.py"
  # hook_get_badge: "{config}/tk-multi-workfiles2/get_badge.py"
  hook_scene_operation: "{config}/tk-multi-workfiles2/scene_operation_perforce.py:{config}/tk-multi-workfiles2/scene_operation_{engine_name}.py"
  # my_tasks_extra_display_fields: [entity.Asset.sg_asset_parent.Asset.code, entity.Asset.sg_asset_category]
  my_tasks_filters: 
    - [task_assignees, is, '{context.user}']
    - [sg_status_list, in, ['rdy','ip']]

# entity_browser_settings
entity_browser_settings: &entity_browser_settings
  entities:
  - caption: Content
    entity_type: Asset
    step_filter_on: Asset
    hierarchy: [sg_asset_library, sg_asset_type, sg_asset_category, code]
    filters:
      - [sg_asset_parent, is, [ null ]]
    sub_hierarchy:
      entity_type: Task
      filters:
      link_field: entity
      hierarchy: [step]
  - caption: Children
    entity_type: Asset
    step_filter_on: Asset    
    hierarchy: [sg_asset_parent.Asset.sg_asset_library, sg_asset_parent.Asset.sg_asset_type, sg_asset_parent.Asset.sg_asset_category, sg_asset_parent.Asset.code, sg_asset_category, sg_folder_name]
    filters: 
      - [sg_asset_parent, is_not, [ null ]]  
    sub_hierarchy:
      entity_type: Task
      filters:
      link_field: entity
      hierarchy: [step]
  - caption: Environment
    entity_type: CustomEntity01
    hierarchy: [sg_asset_library, sg_asset_type, sg_biome, sg_asset_category, sg_asset_class, sg_folder_name]
    filters: 
    sub_hierarchy:
      entity_type: Task
      filters:
      link_field: entity
      hierarchy: [entity,step]    
  - caption: Publishing
    entity_type: CustomEntity03
    hierarchy: [sg_campaign, sg_product.CustomNonProjectEntity01.code, sg_use, code]
    filters: 
    sub_hierarchy:
      entity_type: Task
      filters:
      link_field: entity
      hierarchy: []       
  - caption: Animation
    entity_type: Asset
    hierarchy: [sg_asset_library, sg_asset_type, sg_asset_category, code]
    filters:
      - [sg_asset_parent, is, [ null ]]
    sub_hierarchy:
      entity_type: Task
      filters:    
      link_field: entity
      hierarchy: [step, sg_folder_name, sg_subfolder_name]


# env_entity_browser_settings
entity_browser_settings: &env_entity_browser_settings
  entities:
  - caption: Environment
    entity_type: CustomEntity01
    hierarchy: [sg_asset_library, sg_asset_type, sg_biome, sg_asset_category, sg_folder_name]
    filters:
    sub_hierarchy:
      entity_type: Task
      filters:
      link_field: entity
      hierarchy: [entity]

# anim_entity_browser_settings
entity_browser_settings: &anim_entity_browser_settings
  entities:
  - caption: Animation
    entity_type: Asset
    hierarchy: [sg_asset_library, sg_asset_type, sg_asset_category, code]
    filters:
      - [sg_asset_parent, is, [ null ]]
    sub_hierarchy:
      entity_type: Task
      filters:    
      link_field: entity
      hierarchy: [step, sg_folder_name, sg_subfolder_name] 

# pub_entity_browser_settings
entity_browser_settings: &pub_entity_browser_settings
  entities:
  - caption: Publishing
    entity_type: CustomEntity03
    hierarchy: [sg_campaign, sg_product.CustomNonProjectEntity01.code, sg_use, code]
    filters: 
    sub_hierarchy:
      entity_type: Task
      filters:
      link_field: entity
      hierarchy: []

################################################################################

# This configuration is used whenever a general file manager
# is needed. This configuration doesn't look for files,
# but only lets you switch to a valid work area. When a user
# switches (by selecting a task), the engine is restarted, and
# another environment is loaded in. This environment will
# have another file manager app running, with different settings,
# allowing files to be loaded and saved.
#
# References to this @workfiles2 include typically appears at
# 'transit' levels in the configuration, where work normally
# doesn't happen, but you just want the user to jump to their
# work area. The work area is typically a task or pipeline step
# and these 'transit' areas can be project or asset.

# basic
settings.tk-multi-workfiles2:
  <<: *common_workfiles_settings
  <<: *entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# launches at startup.
settings.tk-multi-workfiles2.launch_at_startup:
  launch_at_startup: true
  <<: *common_workfiles_settings
  <<: *entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

################################################################################

# ---- Desktop Generic

# # asset_step
# settings.tk-multi-workfiles2.asset_step:
#   template_publish: asset_workfile
#   template_publish_area: asset_root
#   template_work: asset_workfile
#   template_work_area: asset_root
#   <<: *common_workfiles_settings
#   <<: *entity_browser_settings
#   location: "@apps.tk-multi-workfiles2.location"

# # asset_child_step
# settings.tk-multi-workfiles2.asset_child_step:
#   template_publish: asset_child_workfile
#   template_publish_area: asset_child_root
#   template_work: asset_child_workfile
#   template_work_area: asset_child_root
#   <<: *common_workfiles_settings
#   <<: *entity_browser_settings
#   location: "@apps.tk-multi-workfiles2.location"

# # anim_asset_step
# settings.tk-multi-workfiles2.anim_asset_step:
#   template_publish: anim_asset_workfile
#   template_publish_area: anim_asset_work_area
#   template_work: anim_asset_workfile
#   template_work_area: anim_asset_work_area
#   <<: *common_workfiles_settings
#   <<: *anim_entity_browser_settings
#   location: "@apps.tk-multi-workfiles2.location"  

# # pub_asset_step
# settings.tk-multi-workfiles2.pub_asset_step:
#   template_publish: pub_asset_workfile
#   template_publish_area: pub_asset_root
#   template_work: pub_asset_workfile
#   template_work_area: pub_asset_root
#   <<: *common_workfiles_settings
#   <<: *pub_entity_browser_settings
#   location: "@apps.tk-multi-workfiles2.location"

# # prod_asset_step
# settings.tk-multi-workfiles2.prod_asset_step:
#   template_publish: prod_asset_workfile
#   template_publish_area: prod_asset_root
#   template_work: prod_asset_workfile
#   template_work_area: prod_asset_root
#   <<: *common_workfiles_settings
#   <<: *pub_entity_browser_settings
#   location: "@apps.tk-multi-workfiles2.location"  

# # env_asset_step
# settings.tk-multi-workfiles2.env_asset_step:
#   template_publish: env_asset_workfile
#   template_publish_area: env_asset_root
#   template_work: env_asset_workfile
#   template_work_area: env_asset_root
#   <<: *common_workfiles_settings
#   my_tasks_extra_display_fields: []  
#   <<: *env_entity_browser_settings
#   location: "@apps.tk-multi-workfiles2.location"

################################################################################

# ---- 3dsmax

# asset_step
settings.tk-multi-workfiles2.3dsmax.asset_step:
  template_publish: asset_max_workfile
  template_publish_area: asset_root
  template_work: asset_max_workfile
  template_work_area: asset_root
  <<: *common_workfiles_settings
  <<: *entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# asset_child_step
settings.tk-multi-workfiles2.3dsmax.asset_child_step:
  template_publish: asset_child_max_workfile
  template_publish_area: asset_child_root
  template_work: asset_child_max_workfile
  template_work_area: asset_child_root
  <<: *common_workfiles_settings
  <<: *entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# anim_asset_step
settings.tk-multi-workfiles2.3dsmax.anim_asset_step:
  template_publish: anim_asset_max_workfile
  template_publish_area: anim_asset_work_area
  template_work: anim_asset_max_workfile
  template_work_area: anim_asset_work_area
  <<: *common_workfiles_settings
  <<: *anim_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"  

# pub_asset_step
settings.tk-multi-workfiles2.3dsmax.pub_asset_step:
  template_publish: pub_asset_max_workfile
  template_publish_area: pub_asset_root
  template_work: pub_asset_max_workfile
  template_work_area: pub_asset_root
  <<: *common_workfiles_settings
  <<: *pub_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# prod_asset_step
settings.tk-multi-workfiles2.3dsmax.prod_asset_step:
  template_publish: prod_asset_max_workfile
  template_publish_area: prod_asset_root
  template_work: prod_asset_max_workfile
  template_work_area: prod_asset_root
  <<: *common_workfiles_settings
  <<: *pub_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"  

# env_asset_step
settings.tk-multi-workfiles2.3dsmax.env_asset_step:
  template_publish: env_asset_max_workfile
  template_publish_area: pub_asset_root
  template_work: env_asset_max_workfile
  template_work_area: env_asset_root
  <<: *common_workfiles_settings
  my_tasks_extra_display_fields: []    
  <<: *env_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

################################################################################

# ---- Houdini

# asset_step
settings.tk-multi-workfiles2.houdini.asset_step:
  template_publish: asset_houdini_workfile
  template_publish_area: asset_root
  template_work: asset_houdini_workfile
  template_work_area: asset_root
  <<: *common_workfiles_settings
  <<: *entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# asset_child_step
settings.tk-multi-workfiles2.houdini.asset_child_step:
  template_publish: asset_child_houdini_workfile
  template_publish_area: asset_child_root
  template_work: asset_child_houdini_workfile
  template_work_area: asset_child_root
  <<: *common_workfiles_settings
  <<: *entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# anim_asset_step
settings.tk-multi-workfiles2.houdini.anim_asset_step:
  template_publish: anim_asset_houdini_workfile
  template_work: anim_asset_houdini_workfile
  <<: *common_workfiles_settings
  <<: *anim_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"  

# pub_asset_step
settings.tk-multi-workfiles2.houdini.pub_asset_step:
  template_publish: pub_asset_houdini_workfile
  template_publish_area: pub_asset_root
  template_work: pub_asset_houdini_workfile
  template_work_area: pub_asset_root
  <<: *common_workfiles_settings
  <<: *pub_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# prod_asset_step
settings.tk-multi-workfiles2.houdini.prod_asset_step:
  template_publish: prod_asset_houdini_workfile
  template_publish_area: prod_asset_root
  template_work: prod_asset_houdini_workfile
  template_work_area: prod_asset_root
  <<: *common_workfiles_settings
  <<: *pub_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"  

# env_asset_step
settings.tk-multi-workfiles2.houdini.env_asset_step:
  template_publish: env_asset_houdini_workfile
  template_publish_area: env_asset_root
  template_work: env_asset_houdini_workfile
  template_work_area: env_asset_root
  <<: *common_workfiles_settings
  my_tasks_extra_display_fields: []    
  <<: *env_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

################################################################################

# ---- Maya

# asset_step
settings.tk-multi-workfiles2.maya.asset_step:
  template_publish: asset_maya_workfile
  template_publish_area: asset_root
  template_work: asset_maya_workfile
  template_work_area: asset_root
  <<: *common_workfiles_settings
  <<: *entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# asset_child_step
settings.tk-multi-workfiles2.maya.asset_child_step:
  template_publish: asset_child_maya_workfile
  template_publish_area: asset_child_root
  template_work: asset_child_maya_workfile
  template_work_area: asset_child_root
  <<: *common_workfiles_settings
  <<: *entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# anim_asset_step
settings.tk-multi-workfiles2.maya.anim_asset_step:
  template_publish: anim_asset_maya_workfile
  template_publish_area: anim_asset_work_area
  template_work: anim_asset_maya_workfile
  template_work_area: anim_asset_work_area
  <<: *common_workfiles_settings
  <<: *anim_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"  

# pub_asset_step
settings.tk-multi-workfiles2.maya.pub_asset_step:
  template_publish: pub_asset_maya_workfile
  template_publish_area: pub_asset_root
  template_work: pub_asset_maya_workfile
  template_work_area: pub_asset_root
  <<: *common_workfiles_settings
  <<: *pub_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# prod_asset_step
settings.tk-multi-workfiles2.maya.prod_asset_step:
  template_publish: prod_asset_maya_workfile
  template_publish_area: prod_asset_root
  template_work: prod_asset_maya_workfile
  template_work_area: prod_asset_root
  <<: *common_workfiles_settings
  <<: *pub_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"  

# env_asset_step
settings.tk-multi-workfiles2.maya.env_asset_step:
  template_publish: env_asset_maya_workfile
  template_publish_area: env_asset_root
  template_work: env_asset_maya_workfile
  template_work_area: env_asset_root
  <<: *common_workfiles_settings
  my_tasks_extra_display_fields: []    
  <<: *env_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

################################################################################

# ---- photoshop

# asset_step
settings.tk-multi-workfiles2.photoshop.asset_step:
  template_publish: asset_photoshop_workfile
  template_publish_area: asset_root
  template_work: asset_photoshop_workfile
  template_work_area: asset_root
  <<: *common_workfiles_settings
  <<: *entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# asset_child_step
settings.tk-multi-workfiles2.photoshop.asset_child_step:
  template_publish: asset_child_photoshop_workfile
  template_publish_area: asset_child_root
  template_work: asset_child_photoshop_workfile
  template_work_area: asset_child_root
  <<: *common_workfiles_settings
  <<: *entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# pub_asset_step
settings.tk-multi-workfiles2.photoshop.pub_asset_step:
  template_publish: pub_asset_photoshop_workfile
  template_publish_area: pub_asset_root
  template_work: pub_asset_photoshop_workfile
  template_work_area: pub_asset_root
  <<: *common_workfiles_settings
  <<: *pub_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# prod_asset_step
settings.tk-multi-workfiles2.photoshop.prod_asset_step:
  template_publish: prod_asset_photoshop_workfile
  template_publish_area: prod_asset_root
  template_work: prod_asset_photoshop_workfile
  template_work_area: prod_asset_root
  <<: *common_workfiles_settings
  <<: *pub_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# env_asset_step
settings.tk-multi-workfiles2.photoshop.env_asset_step:
  template_publish: env_asset_photoshop_workfile
  template_publish_area: env_asset_root
  template_work: env_asset_photoshop_workfile
  template_work_area: env_asset_root
  <<: *common_workfiles_settings
  my_tasks_extra_display_fields: []    
  <<: *env_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

################################################################################

# -- substancepainter

# # project
# settings.tk-multi-workfiles2.substancepainter.project:
#   allow_task_creation: true
#   create_new_task_hook: "{self}/create_new_task.py"
#   custom_actions_hook: "{self}/custom_actions.py"
#   entities:
#   - caption: Assets
#     entity_type: Task
#     filters:
#     - [entity, type_is, Asset]
#     hierarchy: [entity.Asset.sg_asset_type, entity, step, content]
#   - caption: Shots
#     entity_type: Task
#     filters:
#     - [entity, type_is, Shot]
#     hierarchy: [entity.Shot.sg_sequence, entity, step, content]
#   file_extensions: []
#   hook_copy_file: "{self}/copy_file.py"
#   hook_filter_publishes: default
#   hook_filter_work_files: default
#   hook_scene_operation: "{engine}/tk-multi-workfiles2/scene_operation_tk-substancepainter.py"
#   launch_at_startup: false
#   my_tasks_extra_display_fields: []
#   saveas_default_name: scene
#   saveas_prefer_version_up: false
#   show_my_tasks: true
#   template_publish:
#   template_publish_area:
#   template_work:
#   template_work_area:
#   version_compare_ignore_fields: []
#   location: "@apps.tk-multi-workfiles2.location"

# asset_step
settings.tk-multi-workfiles2.substancepainter.asset_step:
  template_publish: asset_substancepainter_workfile
  template_publish_area: asset_root
  template_work: asset_substancepainter_workfile
  template_work_area: asset_root
  <<: *common_workfiles_settings
  <<: *entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# asset_child_step
settings.tk-multi-workfiles2.substancepainter.asset_child_step:
  template_publish: asset_child_substancepainter_workfile
  template_publish_area: asset_child_root
  template_work: asset_child_substancepainter_workfile
  template_work_area: asset_child_root
  <<: *common_workfiles_settings
  <<: *entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# pub_asset_step
settings.tk-multi-workfiles2.substancepainter.pub_asset_step:
  template_publish: pub_asset_substancepainter_workfile
  template_publish_area: pub_asset_root
  template_work: pub_asset_substancepainter_workfile
  template_work_area: pub_asset_root
  <<: *common_workfiles_settings
  <<: *pub_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# prod_asset_step
settings.tk-multi-workfiles2.substancepainter.prod_asset_step:
  template_publish: prod_asset_substancepainter_workfile
  template_publish_area: prod_asset_root
  template_work: prod_asset_substancepainter_workfile
  template_work_area: prod_asset_root
  <<: *common_workfiles_settings
  <<: *pub_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"  

# env_asset_step
settings.tk-multi-workfiles2.substancepainter.env_asset_step:
  template_publish: env_asset_substancepainter_workfile
  template_publish_area: env_asset_root
  template_work: env_asset_substancepainter_workfile
  template_work_area: env_asset_root
  <<: *common_workfiles_settings
  my_tasks_extra_display_fields: []    
  <<: *env_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

################################################################################

# -- substancedesigner

# # project
# settings.tk-multi-workfiles2.substancedesigner.project:
#   allow_task_creation: true
#   create_new_task_hook: "{self}/create_new_task.py"
#   custom_actions_hook: "{self}/custom_actions.py"
#   entities:
#   - caption: Assets
#     entity_type: Task
#     filters:
#     - [entity, type_is, Asset]
#     hierarchy: [entity.Asset.sg_asset_type, entity, step, content]
#   - caption: Shots
#     entity_type: Task
#     filters:
#     - [entity, type_is, Shot]
#     hierarchy: [entity.Shot.sg_sequence, entity, step, content]
#   file_extensions: []
#   hook_copy_file: "{self}/copy_file.py"
#   hook_filter_publishes: default
#   hook_filter_work_files: default
#   hook_scene_operation: "{engine}/tk-multi-workfiles2/scene_operation_tk-substancedesigner.py"
#   launch_at_startup: false
#   my_tasks_extra_display_fields: []
#   saveas_default_name: hook:tk-multi-workfiles2/saveas_default_name_tk-substancedesigner
#   saveas_prefer_version_up: false
#   show_my_tasks: true
#   template_publish:
#   template_publish_area:
#   template_work:
#   template_work_area:
#   version_compare_ignore_fields: []
#   location: "@apps.tk-multi-workfiles2.location"


# asset_step
settings.tk-multi-workfiles2.substancedesigner.asset_step:
  template_publish: asset_substancedesigner_workfile
  template_publish_area: asset_root
  template_work: asset_substancedesigner_workfile
  template_work_area: asset_root
  # saveas_default_name: hook:tk-multi-workfiles2/saveas_default_name_tk-substancedesigner
  <<: *common_workfiles_settings
  <<: *entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# asset_child_step
settings.tk-multi-workfiles2.substancedesigner.asset_child_step:
  template_publish: asset_child_substancedesigner_workfile
  template_publish_area: asset_child_root
  template_work: asset_child_substancedesigner_workfile
  template_work_area: asset_child_root
  # saveas_default_name: hook:tk-multi-workfiles2/saveas_default_name_tk-substancedesigner
  <<: *common_workfiles_settings
  <<: *entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# pub_asset_step
settings.tk-multi-workfiles2.substancedesigner.pub_asset_step:
  template_publish: pub_asset_substancedesigner_workfile
  template_publish_area: pub_asset_root
  template_work: pub_asset_substancedesigner_workfile
  template_work_area: pub_asset_root
  # saveas_default_name: hook:tk-multi-workfiles2/saveas_default_name_tk-substancedesigner
  <<: *common_workfiles_settings
  <<: *pub_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"

# prod_asset_step
settings.tk-multi-workfiles2.substancedesigner.prod_asset_step:
  template_publish: prod_asset_substancedesigner_workfile
  template_publish_area: prod_asset_root
  template_work: prod_asset_substancedesigner_workfile
  template_work_area: prod_asset_root
  # saveas_default_name: hook:tk-multi-workfiles2/saveas_default_name_tk-substancedesigner
  <<: *common_workfiles_settings
  <<: *pub_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"  

# env_asset_step
settings.tk-multi-workfiles2.substancedesigner.env_asset_step:
  template_publish: env_asset_substancedesigner_workfile
  template_publish_area: env_asset_root
  template_work: env_asset_substancedesigner_workfile
  template_work_area: env_asset_root
  # saveas_default_name: hook:tk-multi-workfiles2/saveas_default_name_tk-substancedesigner
  <<: *common_workfiles_settings
  my_tasks_extra_display_fields: []    
  <<: *env_entity_browser_settings
  location: "@apps.tk-multi-workfiles2.location"
